/*
 * File: app/controller/CFrmTimeReport.js
 *
 * This file was generated by Sencha Architect version 3.0.4.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('MyApp.controller.CFrmTimeReport', {
    extend: 'Ext.app.Controller',

    btnTimeReportOKClick: function(button, e, eOpts) {


        Ext.Ajax.request({
            params: {WORKRECORD_ID: MyApp.util.Utilities.userEmpInfo.WORKRECORD_ID,
                     WORK_TYPE_ID:MyApp.util.Utilities.userEmpInfo.WORK_TYPE_ID,
                     LATE_MINUTES:MyApp.util.Utilities.userEmpInfo.LATE_MINUTES},    // Data json transfer to server
            url:  apiUrl +'TimeReport/UpdateWorkrecord',
            success: function (resp) {

                var result = JSON.parse(resp.responseText);  // Parse data return
                if(result.responseCode === 403){
                    MessageCommon.showErrorMessage(result.responseMessage);
                    return;
                }
                if(result == "false")		// Has error at server
                    Ext.MessageBox.alert(MessageCommon.ErrTitle, MessageCommon.MesErrorAtServer);
                else						// Server ok
                {
                    Ext.getCmp('frmTimeReport').close();
                    Ext.getCmp('frmWork').close();
                }

            },
            failure: function () {
                Ext.MessageBox.alert(MessageCommon.ErrTitle, MessageCommon.MesErrorServerFail);
            }
        });


    },

    init: function(application) {
        this.control({
            "#btnTimeReportOK": {
                click: this.btnTimeReportOKClick
            }
        });
    }

});
